# Техническое задание на разработку API для управления транспортными средствами

## 1. Введение

Разработать RESTful API для управления данными о транспортных средствах. API должен обеспечивать возможность добавления,
обновления, удаления и получения информации о транспортных средствах.

## 2. Общие требования

- API должен соответствовать спецификации OpenAPI 3.0.
- Все ответы API должны быть в формате JSON.
- Обработка ошибок должна быть реализована с использованием стандартных кодов состояния HTTP.

## 3. Логика приложения

Приложение представляет собой упрощенную аналогию сервиса, подобного Uber, где администратор управляет водителями и их
транспортными средствами. Основные функции администратора включают:

- **Создание водителя с машиной**: Администратор может добавлять новых водителей в систему, указывая их личные данные и
  информацию о транспортном средстве.
- **Обновление данных водителя и его машины**: Администратор может изменять информацию о водителе, включая его
  контактные данные и характеристики автомобиля.
- **Обновление статуса водителя**: Администратор может изменять статус водителя (например, "в ожидании заказа", "в
  пути", "на паузе"), что позволяет управлять доступностью водителей.
- **Удаление водителя из системы**: Администратор может удалять водителей, которые больше не работают или не нужны в
  системе.
- **Просмотр информации о водителях и транспортных средствах**: Администратор может просматривать список всех водителей
  и их транспортных средств, а также получать детальную информацию о каждом водителе и его автомобиле.

## 4. Эндпоинты API

### 4.1. Эндпоинты для тестирования

- **DELETE** `/api/testing/all-data`
    - **Описание**: Удаляет все данные из всех таблиц/коллекций.
    - **Ответ**: 204 No Content (все данные удалены).

### 4.2. Эндпоинты для управления транспортными средствами

- **GET** `/api/vehicles`
    - **Описание**: Получить список всех транспортных средств.
    - **Ответ**: 200 OK (список всех транспортных средств).

- **POST** `/api/vehicles`
    - **Описание**: Добавить новое транспортное средство.
    - **Запрос**: Тело запроса должно содержать данные в формате `DriverInputDto`.
    - **Ответ**:
        - 201 Created (транспортное средство успешно создано).
        - 400 Bad Request (ошибка валидации).

- **GET** `/api/vehicles/{id}`
    - **Описание**: Получить транспортное средство по ID.
    - **Параметры**:
        - `id` (integer, обязательный): ID транспортного средства.
    - **Ответ**:
        - 200 OK (запрашиваемое транспортное средство).
        - 404 Not Found (транспортное средство не найдено).

- **PUT** `/api/vehicles/{id}`
    - **Описание**: Обновить транспортное средство по ID.
    - **Параметры**:
        - `id` (integer, обязательный): ID транспортного средства.
    - **Запрос**: Тело запроса должно содержать данные в формате `DriverInputDto`.
    - **Ответ**:
        - 204 No Content (транспортное средство успешно обновлено).
        - 400 Bad Request (ошибка валидации).
        - 404 Not Found (транспортное средство не найдено).

- **DELETE** `/api/vehicles/{id}`
    - **Описание**: Удалить транспортное средство по ID.
    - **Параметры**:
        - `id` (integer, обязательный): ID транспортного средства.
    - **Ответ**:
        - 204 No Content (транспортное средство успешно удалено).
        - 404 Not Found (транспортное средство не найдено).

- **PUT** `/api/vehicles/{id}/status`
    - **Описание**: Обновить статус транспортного средства по ID.
    - **Параметры**:
        - `id` (integer, обязательный): ID транспортного средства.
    - **Запрос**: Тело запроса должно содержать данные в формате `VehicleStatusUpdateDto`.
    - **Ответ**:
        - 204 No Content (статус транспортного средства успешно обновлен).
        - 400 Bad Request (неправильное значение статуса).
        - 404 Not Found (транспортное средство не найдено).

## 5. Структуры данных

### 5.1. Driver

- `id`: integer (обязательный)
- `name`: string (обязательный)
- `phoneNumber`: string (обязательный)
- `email`: string (обязательный)
- `status`: string (обязательный, значения: on-order, awaiting-order, on-pause)
- `vehicleMake`: string (обязательный)
- `vehicleModel`: string (обязательный)
- `vehicleYear`: integer (обязательный)
- `vehicleLicensePlate`: string (обязательный)
- `vehicleDescription`: string (необязательный)
- `vehicleFeatures`: array of strings (обязательный, значения: WiFi, ChildSeat, PetFriendly)
- `createdAt`: string (обязательный, формат: date-time)

### 5.2. DriverInputDto

- `name`: string (обязательный)
- `phoneNumber`: string (обязательный)
- `email`: string (обязательный)
- `vehicleMake`: string (обязательный)
- `vehicleModel`: string (обязательный)
- `vehicleYear`: integer (обязательный)
- `vehicleLicensePlate`: string (обязательный)
- `vehicleDescription`: string (необязательный)
- `vehicleFeatures`: array of strings (обязательный, значения: WiFi, ChildSeat, PetFriendly)

### 5.3. VehicleStatusUpdateDto

- `status`: string (обязательный, значения: awaiting-order, on-order, on-pause)

### 5.4. ValidationError

- `field`: string (обязательный, пример: "name")
- `message`: string (обязательный, пример: "Invalid name")

### 5.5. ValidationErrorResponse

- `errorMessages`: array of `ValidationError` (обязательный)

## 6. Обработка ошибок

- Все ошибки должны возвращать соответствующий код состояния HTTP и сообщение об ошибке в формате JSON.
- В случае валидационных ошибок возвращать код 400 с описанием ошибок валидации в формате `ValidationErrorResponse`.

## 7. Безопасность

- API должен поддерживать аутентификацию и авторизацию (например, с использованием токенов JWT или OAuth 2.0).
- Все запросы должны проходить через защищенное соединение (HTTPS).

## 8. Документация

- Документация API должна быть доступна в формате Swagger (OpenAPI) и обновляться при внесении изменений в API.

## 9. Тестирование

- Необходимо разработать тесты для всех эндпоинтов API, включая положительные и отрицательные сценарии.
- Тесты должны проверять корректность обработки запросов и ответов, а также обработку ошибок.

## 10. Заключение

Данное техническое задание описывает основные требования к разработке API для управления транспортными средствами.
Все изменения и дополнения к ТЗ должны быть согласованы с командой разработки и заинтересованными сторонами.

