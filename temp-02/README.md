# Техническое задание на разработку API для управления транспортными средствами

## 1. Введение

Цель данного проекта — разработка RESTful API для управления поездками. API должен обеспечивать возможность создания,
получения и обновления информации о поездках.

## 2. Общие требования

- API должен поддерживать версию 1.0.0.
- Все запросы к API должны использовать базовую аутентификацию.
- Ответы API должны быть в формате JSON.

## 3. Обновление эндпоинтов для использования авторизации

В этой версии API необходимо добавить механизм базовой авторизации (Basic Authentication) для определенных эндпоинтов.
Ниже описаны изменения, которые нужно внести в код программы.
Для следующих эндпоинтов необходимо добавить секцию, указывающую на необходимость базовой авторизации:

- **GET /api/drivers**
    - Добавить в код: требуется базовая авторизация.

- **GET /api/drivers/{id}**
    - Добавить в код: требуется базовая авторизация.

- **POST /api/drivers**
    - Добавить в код: требуется базовая авторизация.

- **PUT /api/drivers/{id}**
    - Добавить в код: требуется базовая авторизация.

- **DELETE /api/drivers/{id}**
    - Добавить в код: требуется базовая авторизация.

- **PUT /api/drivers/{id}/status**
    - Добавить в код: требуется базовая авторизация.

### Реализация логики авторизации в коде

Необходимо реализовать логику обработки базовой авторизации в коде вашего API. Это может включать:

- Проверку заголовка `Authorization` в запросах.
- Валидацию учетных данных (username и пароль).
- Обработку случаев, когда авторизация не удалась (например, возвращение статуса 401 Unauthorized).

## 5. Логика приложения

Приложение представляет собой сервис для управления поездками, аналогичный Uber. Основные функции приложения включают:

- **Создание поездки**: Клиент может заказать новую поездку, указав информацию о себе, водителе и адресах начала и конца
  поездки. При создании поездки система автоматически назначает водителя и транспортное средство.

- **Получение списка всех поездок**: Администратор или клиент может просматривать список всех активных и завершенных
  поездок, что позволяет отслеживать историю поездок и их статусы.

- **Получение информации о поездке по ID**: Пользователь может получить детальную информацию о конкретной поездке,
  используя её уникальный идентификатор. Это включает данные о клиенте, водителе, стоимости и статусе поездки.

- **Обновление статуса поездки**: Администратор или система может обновлять статус поездки (например, "в процессе",
  "отменена", "завершена"). Это позволяет отслеживать текущее состояние поездки и информировать клиента о её статусе.

## 6. Эндпоинты

### 6.1 Получение списка всех поездок

- **Метод**: `GET`
- **Эндпоинт**: `/api/rides`
- **Описание**: Возвращает список всех поездок.
- **Ответ**:
    - **Код 200**: Успешный ответ с массивом объектов `Ride`.

### 6.2 Создание новой поездки

- **Метод**: `POST`
- **Эндпоинт**: `/api/rides`
- **Описание**: Создает новую поездку.
- **Аутентификация**: Требуется базовая аутентификация.
- **Тело запроса**:
    - Должно содержать объект `RideInputDto` с полями:
        - `clientName` (строка, обязательное)
        - `price` (число с плавающей точкой, обязательное)
        - `currency` (строка, обязательное, значения: `usd`, `eur`)
        - `driverId` (целое число, обязательное)
        - `startAddress` (строка, обязательное)
        - `endAddress` (строка, обязательное)
- **Ответ**:
    - **Код 201**: Поездка успешно создана, возвращает объект `Ride`.
    - **Код 400**: Ошибка валидации, возвращает объект `ValidationErrorResponse`.

### 6.3 Получение поездки по ID

- **Метод**: `GET`
- **Эндпоинт**: `/api/rides/{id}`
- **Описание**: Возвращает информацию о поездке по её ID.
- **Параметры**:
    - `id` (целое число, обязательное): ID поездки.
- **Ответ**:
    - **Код 200**: Успешный ответ, возвращает объект `Ride`.
    - **Код 404**: Поездка не найдена.

### 6.4 Обновление статуса поездки по ID

- **Метод**: `PUT`
- **Эндпоинт**: `/api/rides/{id}/status`
- **Описание**: Обновляет статус поездки по её ID.
- **Аутентификация**: Требуется базовая аутентификация.
- **Параметры**:
    - `id` (целое число, обязательное): ID поездки.
- **Тело запроса**:
    - Должно содержать объект с полем `status` (строка, обязательное, значения: `in progress`, `canceled`, `finished`).
- **Ответ**:
    - **Код 204**: Статус поездки успешно обновлён.
    - **Код 400**: Неверное значение статуса, возвращает объект `ValidationErrorResponse`.
    - **Код 404**: Поездка не найдена.

## 7. Схемы данных

### 7.1 Ride

- **Тип**: Объект
- **Свойства**:
    - `id`: Целое число — уникальный идентификатор поездки.
    - `clientName`: Строка — имя клиента, который заказал поездку.
    - `driverId`: Целое число — идентификатор водителя, который выполняет поездку.
    - `driverName`: Строка — имя водителя.
    - `vehicleLicensePlate`: Строка — номерной знак автомобиля.
    - `vehicleName`: Строка — название автомобиля.
    - `price`: Число с плавающей точкой — стоимость поездки.
    - `currency`: Строка — валюта (перечисление: `usd`, `eur`).
    - `status`: Строка — статус поездки (перечисление: `in progress`, `canceled`, `finished`).
    - `createdAt`: Дата и время — дата и время создания поездки.
    - `updatedAt`: Дата и время (может быть null) — дата и время последнего обновления поездки.
    - `address`: Объект — адреса начала и конца поездки.
        - `start`: Строка — адрес начала поездки.
        - `end`: Строка — адрес конца поездки.

### 7.2 RideInputDto

- **Тип**: Объект
- **Свойства**:
    - `clientName`: Строка — имя клиента, который заказывает поездку.
    - `price`: Число с плавающей точкой — стоимость поездки.
    - `currency`: Строка — валюта (перечисление: `usd`, `eur`).
    - `driverId`: Целое число — идентификатор водителя, который будет выполнять поездку.
    - `startAddress`: Строка — адрес начала поездки.
    - `endAddress`: Строка — адрес конца поездки.

### 7.3 ValidationError

- **Тип**: Объект
- **Свойства**:
    - `field`: Строка — имя поля, в котором произошла ошибка (например, "clientName").
    - `message`: Строка — сообщение об ошибке (например, "Имя клиента обязательно").

### 7.4 ValidationErrorResponse

- **Тип**: Объект
- **Свойства**:
    - `errorMessages`: Массив объектов `ValidationError` — список ошибок валидации.

## 8. Заключение

Данное техническое задание описывает основные функции и требования к API для управления поездками. Разработчики должны
следовать указанным спецификациям и логике приложения для успешной реализации проекта. Все изменения и дополнения к ТЗ
должны быть согласованы с командой разработки и заинтересованными сторонами.